# **ğŸ¦… é¸Ÿç±»æ‘„å½± AI è‡ªåŠ¨ç­›é€‰å·¥å…· (Bird Photo AI Sorter) v1.0**

**å‘Šåˆ«â€œæ•°æ¯›â€ç„¦è™‘ï¼Œè®© AI å¸®ä½ ä»æ•°åƒå¼ è¿æ‹ä¸­æŒ‘å‡ºæœ€é”åˆ©çš„ç¬é—´ã€‚**

## **ğŸ“– é¡¹ç›®ç®€ä»‹**

å¯¹äºç”Ÿæ€æ‘„å½±å¸ˆï¼ˆç‰¹åˆ«æ˜¯â€œæ‰“é¸Ÿâ€çˆ±å¥½è€…ï¼‰æ¥è¯´ï¼ŒæŒ‰ä¸€æ¬¡å¿«é—¨å¯èƒ½æ„å‘³ç€æ•°åå¼ è¿æ‹ã€‚ä¸€æ¬¡æ‹æ‘„å›æ¥ï¼Œé¢å¯¹ç¡¬ç›˜é‡Œæ•°åƒå¼  RAW æ ¼å¼çš„é¸Ÿç±»ç…§ç‰‡ï¼Œäººå·¥ç­›é€‰åˆç„¦å‡†ç¡®ã€ç¾½æ¯›æ¸…æ™°çš„â€œæ•°æ¯›ç‰‡â€æ˜¯ä¸€é¡¹å·¨å¤§ä¸”æ¯ç‡¥çš„å·¥ç¨‹ã€‚

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº **æ·±åº¦å­¦ä¹  (Deep Learning)** å’Œ **è®¡ç®—æœºè§†è§‰ (Computer Vision)** çš„è‡ªåŠ¨åŒ–ç­›é€‰å·¥å…·ã€‚å®ƒèƒ½è‡ªåŠ¨è¯†åˆ«é¸Ÿç±»ä¸»ä½“ï¼Œå‰”é™¤èƒŒæ™¯å¹²æ‰°ï¼Œåˆ©ç”¨ç‰©ç†å…‰å­¦çš„é¢‘åŸŸåˆ†æç®—æ³•è¯„ä¼°é”åº¦ï¼Œå¹¶ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹å°†ç…§ç‰‡è‡ªåŠ¨åˆ†ç±»ã€‚

## **âœ¨ ç›®å½•ç»“æ„**

ğŸ“‚ File Structure / æ–‡ä»¶ç»“æ„æœ¬é¡¹ç›®æ ¸å¿ƒä»£ç ç”±ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ç»„æˆï¼Œå„å¸å…¶èŒï¼š.
â”œâ”€â”€ batch_processor_GPU_optimize.py    # [ğŸš€ ä¸»ç¨‹åº] ç”Ÿäº§ç¯å¢ƒå…¥å£ã€‚è¿è¡Œæ­¤æ–‡ä»¶å¼€å§‹æ‰¹é‡ç­›é€‰ç…§ç‰‡ã€‚
â”‚                                      # åŒ…å«å…¨æµç¨‹é€»è¾‘ï¼šåŠ è½½ -> è¯†åˆ« -> ç‰¹å¾æå– -> åˆ†ç±» -> å½’æ¡£/æ ‡æ³¨ã€‚
â”‚
â”œâ”€â”€ detect_birds_multi_maskenabled.py  # [ğŸ‘ï¸ è§†è§‰æ ¸å¿ƒ] å°è£…äº† YOLOv8 å®ä¾‹åˆ†å‰²é€»è¾‘ã€‚
â”‚                                      # è´Ÿè´£å›¾åƒçš„æ™ºèƒ½è£åˆ‡ã€Mask ç”Ÿæˆä»¥åŠèƒŒæ™¯åƒç´ å‰”é™¤ã€‚
â”‚
â”œâ”€â”€ data_labler.py                     # [ğŸ·ï¸ æ ‡è®°å·¥å…·] ç”¨äºäººå·¥æ„å»º"çœŸå€¼æ•°æ®"ã€‚
â”‚                                      # æä¾›å¿«æ·é”®äº¤äº’ç•Œé¢ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå°†ç…§ç‰‡æ ‡è®°ä¸º Trash/Soft/Perfectã€‚
â”‚
â”œâ”€â”€ train_classifier_GPU.py            # [ğŸ§  è®­ç»ƒä¸­å¿ƒ] ç”¨äºè®­ç»ƒä¸“å± AI æ¨¡å‹ã€‚
â”‚                                      # è¯»å–æ ‡è®°æ•°æ®ï¼Œåˆ©ç”¨ GPU åŠ é€Ÿæå–ç‰¹å¾ï¼Œå¹¶è®­ç»ƒéšæœºæ£®æ—åˆ†ç±»å™¨ã€‚
â”‚
â”œâ”€â”€ best_bird_model_multiclass.pkl     # [ğŸ’¾ æ¨¡å‹æ–‡ä»¶] è®­ç»ƒå¥½çš„éšæœºæ£®æ—åˆ†ç±»å™¨æƒé‡ã€‚
â”‚                                      # ä¸»ç¨‹åºè¿è¡Œæ—¶ä¼šç›´æ¥åŠ è½½æ­¤æ–‡ä»¶è¿›è¡Œæ¨ç†ã€‚
â”‚
â”œâ”€â”€ .gitignore                         # Git å¿½ç•¥é…ç½®ï¼Œé˜²æ­¢ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶æˆ–è¿‡å¤§çš„ PyTorch æ¨¡å‹ã€‚
â””â”€â”€ README.md                          # é¡¹ç›®è¯´æ˜æ–‡æ¡£ã€‚
ğŸ”§ æ¨¡å—è°ƒç”¨å…³ç³» (Module Dependency)batch_processor_GPU_optimize.py ä¾èµ–äºï¼šdetect_birds_multi_maskenabled.py (ç”¨äºçœ‹)best_bird_model_multiclass.pkl (ç”¨äºæƒ³)train_classifier_GPU.py è¿è¡Œåç”Ÿæˆï¼šbest_bird_model_multiclass.pkl
---

### ğŸ’¡ ç»™æ‚¨çš„å¾®è°ƒå»ºè®®

æ‚¨å¯ä»¥æ£€æŸ¥ä¸€ä¸‹ä»£ç ä¸­çš„ `import` è¯­å¥ï¼Œç¡®ä¿æ–‡ä»¶åå˜æ›´åå¼•ç”¨ä¾ç„¶æ­£ç¡®ã€‚ä¾‹å¦‚ï¼Œåœ¨ `batch_processor_GPU_optimize.py` å’Œ `train_classifier_GPU.py` çš„å¼€å¤´ï¼Œå¯¼å…¥æ¨¡å—çš„éƒ¨åˆ†åº”è¯¥æ˜¯ï¼š

```python
# ç¡®ä¿ import çš„åå­—å’Œæ‚¨æˆªå›¾ä¸­çš„æ–‡ä»¶åä¸€è‡´
from detect_birds_multi_maskenabled import BirdDetector, load_best_available_image

## **âœ¨ æ ¸å¿ƒç‰¹æ€§**

* **âš¡ å…¨æµç¨‹ GPU åŠ é€Ÿ**ï¼šåŸºäº PyTorch Tensor çš„æ‰¹é‡åŒ–å¤„ç†æ¶æ„ã€‚åˆ©ç”¨ RTX æ˜¾å¡è¿›è¡Œå¹¶è¡Œçš„ FFTï¼ˆå‚…é‡Œå¶å˜æ¢ï¼‰å’Œæ¢¯åº¦è®¡ç®—ï¼Œååé‡æé«˜ã€‚  
* **ğŸ¯ åƒç´ çº§ç²¾å‡†è¯†åˆ«**ï¼šé‡‡ç”¨ **YOLOv8-Instance Segmentation** æ¨¡å‹ï¼Œä¸ä»…èƒ½æ¡†å‡ºé¸Ÿï¼Œè¿˜èƒ½ç”Ÿæˆåƒç´ çº§è’™ç‰ˆï¼ˆMaskï¼‰ï¼Œç‰©ç†å‰”é™¤æ ‘æã€æ ‘å¶ç­‰é”åˆ©èƒŒæ™¯çš„å¹²æ‰°ã€‚  
* **ğŸ”¬ é¢‘åŸŸé”åº¦åˆ†æ**ï¼šæ‘’å¼ƒä¼ ç»Ÿçš„å•ä¸€æ¢¯åº¦è¯„ä»·ï¼Œå¼•å…¥ FFT é¢‘è°±èƒ½é‡åˆ†æï¼Œç»“åˆä¸­å¿ƒåŠ æƒé€»è¾‘ï¼Œæ›´æ¥è¿‘äººçœ¼å¯¹â€œçº¹ç†è´¨æ„Ÿâ€çš„åˆ¤æ–­ã€‚  
* **ğŸ§  æ™ºèƒ½ä¸‰çº§åˆ†ç±»**ï¼šåŸºäº **Random Forest (éšæœºæ£®æ—)** çš„åˆ†ç±»å™¨ï¼Œå°†ç…§ç‰‡åˆ†ä¸ºï¼š  
  * **ğŸ—‘ï¸ Trash (åºŸç‰‡)**ï¼šä¸¥é‡è·‘ç„¦ï¼Œå»ºè®®ç›´æ¥åˆ é™¤ã€‚  
  * **ğŸ˜ Soft (éƒ¨åˆ†å¤±ç„¦)**ï¼šç¼©å›¾å¯ç”¨ï¼Œä½†ç»†èŠ‚ä¸è¶³ï¼Œéœ€äººå·¥å¤å®¡ã€‚  
  * **ğŸ† Perfect (å®Œç¾)**ï¼šæ•°æ¯›çº§é”åˆ©ï¼Œç›´æ¥å‡ºç‰‡ã€‚  
* **ğŸ“¥ æ— æŸå·¥ä½œæµ (Lightroom Friendly)**ï¼šæ”¯æŒç”Ÿæˆ .xmp å…ƒæ•°æ®æ–‡ä»¶ã€‚å¯¼å…¥ Lightroom åè‡ªåŠ¨æ ‡è®°é¢œè‰²æ ‡ç­¾ï¼ˆçº¢/ç´«/ç»¿ï¼‰å’Œæ˜Ÿçº§ï¼Œæ— éœ€ç‰©ç†ç§»åŠ¨ RAW æ–‡ä»¶ã€‚  
* **ğŸ“¸ å…¨æ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒ Nikon Z8/Z9 çš„é«˜æ•ˆç‡æ˜Ÿ (HE\*) RAWï¼Œä»¥åŠ Sony ARW, Canon CR3 ç­‰ä¸»æµæ ¼å¼ï¼ˆé€šè¿‡æå–å†…åµŒå…¨å°ºå¯¸é¢„è§ˆå›¾å®ç°æé€Ÿè¯»å–ï¼‰ã€‚

## **ğŸ› ï¸ æŠ€æœ¯åŸç† (The "Secret Sauce")**

1. **å¹¶è¡Œ IO åŠ è½½**ï¼šä½¿ç”¨ ThreadPoolExecutor å¤šçº¿ç¨‹å¹¶è¡Œè¯»å– RAW æ–‡ä»¶å¹¶è§£ç ä¸ºå†…å­˜å›¾åƒï¼Œè§£å†³ CPU è¯»ç›˜ç“¶é¢ˆã€‚  
2. **æ™ºèƒ½è£åˆ‡ (Mask-Aware Crop)**ï¼š  
   * ä½¿ç”¨ YOLOv8x-seg è¯†åˆ«é¸Ÿç±»è½®å»“ã€‚  
   * è®¡ç®—ç´§è‡´åŒ…å›´ç›’ (Tight Bounding Box)ã€‚  
   * **èƒŒæ™¯æ¶‚é»‘**ï¼šåˆ©ç”¨ Mask å°†éé¸Ÿç±»åŒºåŸŸç½®ä¸ºçº¯é»‘ï¼Œå¹¶è¿›è¡ŒäºŒæ¬¡è…èš€ (Erosion) å»é™¤è¾¹ç¼˜è™šå½±ï¼Œå½»åº•æ¶ˆé™¤èƒŒæ™¯å¯¹é”åº¦è¯„åˆ†çš„å¹²æ‰°ã€‚  
3. **å¤šç»´ç‰¹å¾æå–**ï¼š  
   * **å†…éƒ¨å³°å€¼æ¢¯åº¦ (Inner Peak Gradient)**ï¼šåªè®¡ç®—é¸Ÿèº«ä½“å†…éƒ¨æœ€é”åˆ©çš„ 5% åƒç´ ï¼ŒåŒºåˆ†â€œå¾®ç³Šâ€å’Œâ€œæè‡´â€ã€‚  
   * **FFT é¢‘æ®µèƒ½é‡**ï¼šåˆ†æä¸­é«˜é¢‘çº¹ç†èƒ½é‡ï¼Œåˆ¤æ–­å™ªç‚¹ä¸ç»†èŠ‚ã€‚  
   * **çº¹ç†å¤æ‚åº¦**ï¼šè®¡ç®—æ¢¯åº¦æ ‡å‡†å·®ã€‚  
4. **åˆ†ç±»å†³ç­–**ï¼šå°†æå–çš„ 6 ç»´ç‰¹å¾é€å…¥è®­ç»ƒå¥½çš„éšæœºæ£®æ—æ¨¡å‹ï¼Œè¾“å‡ºåˆ†ç±»æ¦‚ç‡ã€‚

## **ğŸš€ å¿«é€Ÿå¼€å§‹**

### **1\. ç¯å¢ƒä¾èµ–**

æœ¬é¡¹ç›®ä¸¥é‡ä¾èµ– GPU è®¡ç®—ï¼Œè¯·ç¡®ä¿å®‰è£…äº† NVIDIA æ˜¾å¡é©±åŠ¨åŠ CUDA æ”¯æŒã€‚

\# 1\. å®‰è£… PyTorch (è¯·æ ¹æ®ä½ çš„ CUDA ç‰ˆæœ¬å» pytorch.org è·å–æœ€æ–°å‘½ä»¤)  
\# é’ˆå¯¹ RTX 40/50 ç³»åˆ—ï¼Œå»ºè®®å®‰è£… Preview ç‰ˆä»¥æ”¯æŒæ–°æ¶æ„  
pip install \--pre torch torchvision torchaudio \--index-url \[https://download.pytorch.org/whl/nightly/cu126\](https://download.pytorch.org/whl/nightly/cu126)

\# 2\. å®‰è£…å…¶ä»–ä¾èµ–  
pip install ultralytics opencv-python numpy scikit-learn tqdm rawpy joblib

### **2\. å»ºç«‹è‡ªå·±çš„æ ‡å‡† (å¯é€‰ä½†æ¨è)**

æ¯ä¸ªäººçš„é•œå¤´ç´ è´¨å’Œå¯¹â€œé”åˆ©â€çš„å®šä¹‰ä¸åŒï¼Œå»ºè®®è®­ç»ƒä¸“å±æ¨¡å‹ï¼š

1. è¿è¡Œ data\_labeler.pyï¼Œæ‰‹åŠ¨æ ‡è®°çº¦ 100-200 å¼ å…¸å‹ç…§ç‰‡ï¼ˆæŒ‰ 1/2/3 é”®åˆ†ç±»ï¼‰ã€‚  
2. è¿è¡Œ train\_classifier\_gpu\_batch.pyï¼Œç¨‹åºä¼šè‡ªåŠ¨å¯»æ‰¾æœ€ä½³å‚æ•°å¹¶ç”Ÿæˆ best\_bird\_model\_multiclass.pklã€‚

### **3\. å¼€å§‹ç­›é€‰**

è¿è¡Œä¸»ç¨‹åºï¼š

python batch\_processor\_final\_multiclass.py

ç¨‹åºä¼šè¯¢é—®æ¨¡å¼ï¼š

* **\[1\] æ•´ç†æ¨¡å¼**ï¼šç‰©ç†ç§»åŠ¨æ–‡ä»¶åˆ° Trash, Soft, Perfect æ–‡ä»¶å¤¹ã€‚  
* **\[2\] æ ‡æ³¨æ¨¡å¼**ï¼šç”ŸæˆåŒå .xmp æ–‡ä»¶ï¼ˆæ¨èï¼‰ã€‚

## **ğŸ“ ç»“æœç»Ÿè®¡å‚è€ƒ**

åœ¨ RTX 5060 Laptop ä¸ŠåŸºäº 1470 å¼ æ ·æœ¬çš„æµ‹è¯•æ•°æ®ï¼š

| ç±»åˆ« | å‡†ç¡®ç‡ (Precision) | å¬å›ç‡ (Recall) | è¯´æ˜ |
| :---- | :---- | :---- | :---- |
| **Trash** | 83% | 76% | æå°‘è¯¯åˆ ï¼Œå¤§éƒ¨åˆ†åºŸç‰‡èƒ½è¢«å‡†ç¡®è¯†åˆ«ã€‚ |
| **Perfect** | 76% | 72% | é€‰å‡ºæ¥çš„ç…§ç‰‡å«é‡‘é‡é«˜ï¼Œå¤§å¤šä¸ºæè‡´é”åˆ©ã€‚ |
| **Soft** | 65% | 73% | å……å½“â€œç¼“å†²åŒºâ€ï¼Œä¸»è¦åŒ…å«å™ªç‚¹é«˜æˆ–è½»å¾®æŠ–åŠ¨çš„ç…§ç‰‡ã€‚ |

## **ğŸ—ºï¸ åç»­æ”¹è¿›è·¯çº¿å›¾ (Roadmap)**

è™½ç„¶ v1.0 ç‰ˆæœ¬å·²ç»å…·å¤‡ç”Ÿäº§åŠ›ï¼Œä½†æˆ‘ä»¬ä»æœ‰æ”¹è¿›ç©ºé—´ï¼š

### **1\. ä¼˜åŒ– "Soft" ä¸­é—´æ€çš„çº¯å‡€åº¦**

* **ç°çŠ¶**ï¼šç›®å‰ Soft ç»„æ˜¯ä¸€ä¸ªâ€œå¤§æ‚çƒ©â€ï¼Œæ—¢æ··æœ‰è½»å¾®è·‘ç„¦çš„å¥½å›¾ï¼Œä¹Ÿæœ‰å™ªç‚¹è¿‡é«˜çš„çƒ‚å›¾ã€‚  
* **è®¡åˆ’**ï¼šå¼•å…¥æ›´ç»†ç²’åº¦çš„ç‰¹å¾ï¼ˆå¦‚è‰²å½©å™ªå£°åˆ†æï¼‰ï¼Œæˆ–å°è¯•å°†ä¸‰åˆ†ç±»æ‰©å±•ä¸ºäº”åˆ†ç±»ï¼ˆåŠ å…¥ ISO\_High æ ‡ç­¾ï¼‰ï¼Œè¿›ä¸€æ­¥æçº¯ Soft ç»„ã€‚

### **2\. å¢å¼ºå¯¹â€œé£ç‰ˆâ€è¿åŠ¨æ¨¡ç³Šçš„è¯†åˆ«**

* **ç°çŠ¶**ï¼šå¯¹äºé£è¡Œä¸­çš„é¸Ÿç±»ï¼Œç®—æ³•å¯èƒ½ä¼šå› ä¸ºâ€œè¿åŠ¨æ¨¡ç³Šï¼ˆMotion Blurï¼‰â€å¯¼è‡´çš„è¾¹ç¼˜æŸ”åŒ–ï¼Œå°†å…¶è¯¯åˆ¤ä¸ºå¤±ç„¦ï¼ˆSoftï¼‰ï¼Œä»è€Œä½ä¼°å…¶ä»·å€¼ï¼ˆé£ç‰ˆé€šå¸¸å…è®¸è½»å¾®æ¨¡ç³Šï¼‰ã€‚  
* **è®¡åˆ’**ï¼šå¼•å…¥æ–¹å‘æ€§æ¢¯åº¦æ£€æµ‹ï¼ˆDirectional Gradientï¼‰æˆ–å…‰æµæ³•ï¼Œè¯†åˆ«â€œçº¿æ€§æ¨¡ç³Šâ€ï¼Œç»™äºˆé£ç‰ˆç…§ç‰‡ç‰¹å®šçš„æƒé‡è¡¥å¿ã€‚

### **3\. æå‡ç¡¬ä»¶å…¼å®¹æ€§**

* **ç°çŠ¶**ï¼šç›®å‰ç®—æ³•æ·±åº¦ç»‘å®š CUDA å’Œ NVIDIA GPUï¼Œæ— æ³•åœ¨ Mac (Metal) æˆ– AMD æ˜¾å¡ä¸Šé«˜æ•ˆè¿è¡Œã€‚  
* **è®¡åˆ’**ï¼šé‡æ„æ¨ç†åç«¯ï¼Œæ”¯æŒ ONNX Runtime æˆ– MPS åŠ é€Ÿï¼Œé€‚é…æ›´å¤šç¡¬ä»¶å¹³å°ã€‚

### **4\. å¼€å‘å›¾å½¢åŒ–ç•Œé¢ (GUI)**

* **ç°çŠ¶**ï¼šç›®å‰ä¸»è¦ä¾èµ–å‘½ä»¤è¡Œäº¤äº’ã€‚  
* **è®¡åˆ’**ï¼šä½¿ç”¨ PyQt æˆ– Gradio å¼€å‘å¯è§†åŒ–ç•Œé¢ï¼Œæ”¯æŒæ‹–æ‹½æ–‡ä»¶å¤¹ã€å®æ—¶é¢„è§ˆ ROIã€æ‰‹åŠ¨å¾®è°ƒé˜ˆå€¼ä»¥åŠç›´è§‚çš„å›¾è¡¨åˆ†æã€‚

### **5\. é…ç½®æ–‡ä»¶ä¸è°ƒä¼˜æµç¨‹ä¼˜åŒ–**

* **ç°çŠ¶**ï¼šå‚æ•°ï¼ˆå¦‚ ROI\_SIZE, FFT\_CUTOFFï¼‰ç¡¬ç¼–ç åœ¨ Python æ–‡ä»¶ä¸­ã€‚  
* **è®¡åˆ’**ï¼šå¼•å…¥ config.yaml é…ç½®æ–‡ä»¶ã€‚å¹¶å°† train \-\> eval \-\> run çš„æµç¨‹æ•´åˆä¸ºä¸€é”®å¼â€œæ ¡å‡†å‘å¯¼â€ï¼Œè®©ä¸æ‡‚ä»£ç çš„æ‘„å½±å¸ˆä¹Ÿèƒ½è½»æ¾è®­ç»ƒè‡ªå·±çš„ AI åŠ©æ‰‹ã€‚

## **ğŸ¤ è´¡çŒ®ä¸è®¸å¯**

æ¬¢è¿æäº¤ Issue æˆ– Pull Request æ¥æ”¹è¿›è¿™ä¸ªå·¥å…·ï¼

License: MIT

\#\#\# è¡¥å……å»ºè®® (é’ˆå¯¹ä½ æåˆ°çš„ç¬¬ 5 ç‚¹)

å¯¹äºç¬¬ 5 ç‚¹ \*\*â€œé€šè¿‡å‚æ•°é…ç½®æ–‡ä»¶ä¼˜åŒ–è°ƒä¼˜æµç¨‹â€\*\*ï¼Œå»ºè®®åœ¨åç»­å¼€å‘ä¸­å¼•å…¥ \`yaml\` æˆ– \`json\` é…ç½®æ–‡ä»¶ã€‚

ä¾‹å¦‚åˆ›å»ºä¸€ä¸ª \`config.yaml\`ï¼š

\`\`\`yaml  
system:  
  gpu\_enabled: true  
  num\_workers: 8  
  batch\_size: 16

algorithm:  
  roi\_size: 1600  
  fft\_low\_cut: 0.05  
  fft\_high\_cut: 0.65  
  gaussian\_sigma: 0.5

lightroom:  
  label\_trash: "ç´«è‰²"  
  label\_soft: "çº¢è‰²"  
  label\_perfect: "ç»¿è‰²"  
